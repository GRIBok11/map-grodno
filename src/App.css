/* ===== ИСПРАВЛЕНИЯ ДЛЯ ВИДИМОСТИ ПАНЕЛЕЙ ===== */

/* Основной контейнер приложения */
.app-container {
  position: relative;
  height: 100vh;
  width: 100vw;
  overflow: hidden;
}

/* Верхняя панель управления - ФИКСИРОВАННАЯ ПОЗИЦИЯ */
.top-controls {
  position: fixed !important;
  top: 20px !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  display: flex !important;
  align-items: center !important;
  gap: 16px !important;
  padding: 16px 24px !important;
  background: var(--gradient-glass) !important;
  backdrop-filter: var(--backdrop-blur) var(--backdrop-saturate) !important;
  border: 1px solid rgba(255, 255, 255, 0.2) !important;
  border-radius: 24px !important;
  box-shadow: var(--shadow-soft) !important;
  z-index: 10000 !important; /* Увеличиваем z-index */
  min-width: max-content !important;
  transition: all 0.3s var(--ease-out) !important;
}

/* Левая часть контролов */
.controls-left {
  display: flex !important;
  align-items: center !important;
  gap: 12px !important;
}

/* Правая часть контролов */
.controls-right {
  display: flex !important;
  align-items: center !important;
  gap: 12px !important;
  margin-left: auto !important;
}

/* Контейнер карты - УЧИТЫВАЕМ ПАНЕЛИ */
.map-container {
  position: absolute !important;
  top: 0 !important; /* Карта начинается с верха */
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  z-index: 1 !important; /* Карта под панелями */
  background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%) !important;
}

/* Боковая панель - ФИКСИРОВАННАЯ ПОЗИЦИЯ */
.side-panel {
  position: fixed !important;
  top: 100px !important; /* Отступ от верхней панели */
  right: 20px !important;
  bottom: 20px !important;
  width: 380px !important;
  background: var(--gradient-glass) !important;
  backdrop-filter: var(--backdrop-blur) var(--backdrop-saturate) !important;
  border: 1px solid rgba(255, 255, 255, 0.25) !important;
  border-radius: 24px !important;
  box-shadow: var(--shadow-floating) !important;
  display: flex !important;
  flex-direction: column !important;
  z-index: 9999 !important; /* Высокий z-index, но ниже верхней панели */
  transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) !important;
  overflow: hidden !important;
}

/* Состояния боковой панели */
.side-panel.open {
  transform: translateX(0) !important;
  opacity: 1 !important;
  visibility: visible !important;
}

.side-panel.closed {
  transform: translateX(calc(100% + 20px)) !important;
  opacity: 0 !important;
  visibility: hidden !important;
}

/* Убедимся, что кнопка переключения панели видна */
.panel-toggle {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  width: 48px !important;
  height: 48px !important;
  background: var(--gradient-primary) !important;
  border: none !important;
  border-radius: 16px !important;
  color: white !important;
  cursor: pointer !important;
  transition: all 0.3s var(--ease-out) !important;
  box-shadow: 0 8px 25px rgba(67, 97, 238, 0.3) !important;
  z-index: 10001 !important; /* Самая высокая позиция */
}

.panel-toggle:hover {
  transform: translateY(-2px) scale(1.05) !important;
  box-shadow: 0 12px 35px rgba(67, 97, 238, 0.4) !important;
}

/* Адаптивность для мобильных устройств */
@media (max-width: 768px) {
  .top-controls {
    top: 10px !important;
    left: 10px !important;
    right: 10px !important;
    transform: none !important;
    flex-wrap: wrap !important;
    padding: 12px !important;
    border-radius: 20px !important;
  }
  
  .controls-left, .controls-right {
    flex: 1 1 100% !important;
    justify-content: center !important;
    margin: 4px 0 !important;
  }
  
  .side-panel {
    top: 80px !important;
    right: 10px !important;
    bottom: 10px !important;
    width: calc(100vw - 20px) !important;
    max-width: 400px !important;
  }
}

/* Дополнительные гарантии видимости */
.control-card {
  background: var(--gradient-surface) !important;
  backdrop-filter: blur(12px) !important;
  border: 1px solid rgba(255, 255, 255, 0.18) !important;
  border-radius: 20px !important;
  padding: 12px !important;
  transition: all 0.25s var(--ease-out) !important;
  position: relative !important;
  overflow: hidden !important;
}

/* Убедимся, что все элементы видны */
.controls-left .control-card,
.controls-right .control-card {
  opacity: 1 !important;
  visibility: visible !important;
}

/* Анимация появления для уверенности */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.top-controls {
  animation: fadeIn 0.6s var(--ease-out) !important;
}

/* Исправления для специфичности */
body .top-controls {
  display: flex !important;
}

body .side-panel {
  display: flex !important;
}

/* Убедимся, что ничего не перекрывает панели */
.leaflet-container {
  z-index: 1 !important;
}

.leaflet-control-container {
  z-index: 2 !important;
}

/* Дополнительные стили для вложенных элементов */
.toggles {
  display: flex !important;
  gap: 8px !important;
  padding: 4px !important;
  background: rgba(255, 255, 255, 0.1) !important;
  border-radius: 18px !important;
  backdrop-filter: blur(10px) !important;
}

.btn-row {
  display: flex !important;
  gap: 8px !important;
  align-items: center !important;
}

/* Исправление для файлового инпута */
.file-label {
  position: relative !important;
  cursor: pointer !important;
  display: flex !important;
  align-items: center !important;
  gap: 8px !important;
}

.file-label input[type="file"] {
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  width: 100% !important;
  height: 100% !important;
  opacity: 0 !important;
  cursor: pointer !important;
}